<html>

<body>
  <div id="output">
    </div>
    <div id="chatControls">
        <input type="text" placeholder="Your Message here" id="text">
        <button onclick="sendText()">Send</button>
    </div>
  <script>
    var name = prompt("whats your name? ")
    var HOST = location.origin.replace(/^http/, 'ws')
    var sock = new WebSocket(HOST);
    sock.onopen = function () {
      sock.send(JSON.stringify({
        type: 'name',
        data: name
      }));
    }
    var log = document.getElementById('output');

    sock.onmessage = function (event) {
      console.log(event);
      var json = JSON.parse(event.data);

      log.innerHTML += json.name + ":" + json.data + "<br>"
    }
    function sendText() {
      var text = document.getElementById('text').value;
      console.log(text);
      // sock.send(text);
      sock.send(JSON.stringify({
        type: "message",
        data: text
      }));
      log.innerHTML += "You : " + text + "<br>"
    }
  </script>
</body>

</html>